!function(t){function e(i){if(a[i])return a[i].exports;var r=a[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("barchart",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"},title:{default:""}},onDataLoaded:function(t){console.log(this.name+":Data Loaded!"),this.reload=!0,t.target.components[this.name].update(this.data)},init:function(){this.name;this.loaded=!1,this.el.addEventListener("data-loaded",this.onDataLoaded.bind(this))},update:function(t){if(this.el._data&&this.el._data.length>0||this.el._group)if(this.reload){for(;this.el.firstChild;)this.el.firstChild.parentNode.removeChild(this.el.firstChild);this.initChart(),this.reload=!1,this.el.setAttribute("visible",!0)}else{var e=AFRAME.utils.diff(t,this.data);if(""!==e.title){var a=this.el.querySelector("[title]");a&&a.setAttribute("title","caption",e.title)}}},initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a,i=function(t,e){var a=e/2+t;return a},r=function(){var t,e=[];t=Math.max.apply(null,arguments);for(var a=0;a<arguments.length;a++)e.push(arguments[a]/t);return e};t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all());var n=a.map(function(e){return t._valueHandler?t._valueHandler(e):e.value});n=r.apply(null,n),BAR_WIDTH=e.width/n.length,BAR_DEPTH=e.depth,MAX_HEIGHT=e.height,COLORS=["#2338D9","#23A2D9","#23D978","#BAD923","#D923D3"];var l,d,o;document.createElement("a-entity");l=BAR_WIDTH/2,d=0,o=e.depth/2;for(var s=0;s<n.length;s++){var h=n[s]*MAX_HEIGHT,u=i(d,h),p=document.createElement("a-box"),c=e.color||COLORS[s%COLORS.length],v={x:l,y:u,z:0};p.setAttribute("width",BAR_WIDTH),p.setAttribute("height",h),p.setAttribute("depth",BAR_DEPTH),p.setAttribute("color",c),p.setAttribute("position",v),l+=BAR_WIDTH;var f=a[s].value;t._valueHandler&&(f=t._valueHandler(a[s]));var _=a[s].key;t._keyHandler&&(_=t._keyHandler(a[s]));var m={name:"key:"+_+" value:"+f,data:{key:a[s].key,value:f},position:{x:v.x,y:d+MAX_HEIGHT+.25,z:v.z+o},origin_color:c};p._partData=m,t.appendChild(p);var g=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var r=i.allCharts(),n=0;n<r.length;n++)r[n]!==t.el&&r[n]._group&&r[n].emit("data-loaded");else for(var l=t.el.parentElement.children,n=0;n<l.length;n++)l[n]!==t.el&&l[n]._group&&l[n].emit("data-loaded");t.el.emit("filtered",{element:e})}},A=g.bind(null,this,p._partData);p.addEventListener("click",A)}this.addEvents();for(var b=this.addYLabels(),y=0;y<b.length;y++)t.appendChild(b[y]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(t){var e=document.createElement("a-entity");e.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),e.setAttribute("position",{x:0,y:0,z:-this.data.depth/2}),this.el.appendChild(e)},addTitle:function(){var t=document.createElement("a-entity");t.setAttribute("title",{caption:this.data.title,width:Math.max(this.data.width/2,6)}),t.setAttribute("position",{x:this.data.width/2,y:this.data.height+1,z:0}),this.el.appendChild(t)},addEvents:function(){for(var t=function(t,i){i.addEventListener("mouseenter",e.bind(t,i)),i.addEventListener("mouseleave",a.bind(t,i))},e=function(t){n(this,t),l(t)},a=function(t){i(t),r(t)},i=function(t){var e=t;e.setAttribute("color",t._partData.origin_color)},r=function(t){var e=t.parentElement,a=e.querySelector("#tooltip");a&&e.removeChild(a)},n=function(t,e){var a;a=document.createElement("a-entity");var i=Number.parseInt(e._partData.origin_color.replace("#","0x"))-1315860;i="#"+("000000"+i.toString(16)).slice(-6);var r=6;a.setAttribute("text",{color:"#000000",side:"double",value:t._tooltip?t._tooltip(e.data):e._partData.name,width:r,wrapCount:30});var n={x:e._partData.position.x+r/2,y:e._partData.position.y,z:e._partData.position.z};a.id="tooltip",a.setAttribute("position",n),e.parentElement.appendChild(a)},l=function(t){var e=t,a=e.getObject3D("mesh").material.color.getHex(),i=16777215^a;e.setAttribute("color","#"+("000000"+i.toString(16)).slice(-6))},d=0;d<this.el.children.length;d++)t(this.el,this.el.children[d])},addYLabels:function(){var t,e,a,i=function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var r=-.7,n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var l={x:r,y:n,z:-t.data.depth/2};return i.setAttribute("position",l),i},r=this.el;a=this.el._data?this.el._data:this.el._group.top(1/0);var n=a.map(function(t){return r._valueHandler?r._valueHandler(t):t.value});e=Math.max.apply(null,n),t=n.length;for(var l=e/this.data.ysteps,d=this.data.height/this.data.ysteps,o=[],s=0;s<this.data.ysteps+1;s++)o.push(i(this,s*d,s*l));return o},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))}})}]);