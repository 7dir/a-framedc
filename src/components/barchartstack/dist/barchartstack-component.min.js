!function(t){function e(i){if(a[i])return a[i].exports;var n=a[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){a(2),a(3);var i=a(1);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("barchartstack",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"},title:{default:""}},multiple:!1,onDataLoaded:i.onDataLoaded,init:i.default_init,update:i.default_update,initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a,i=function(t,e){var a=e/2+t;return a};t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all()),BAR_WIDTH=e.width/a.length,BAR_DEPTH=e.depth,MAX_HEIGHT=e.height,MAX_VALUE=t._maxfunc(t._group.order(t._maxfunc).top(1)[0].value);var n,r,o;document.createElement("a-entity");n=BAR_WIDTH/2,r=0,o=e.depth/2;for(var d=0;d<a.length;d++){var l=a[d].value.slice();l.sort(function(t,e){return t.value<e.value?1:t.value>e.value?-1:0});for(var s=0;s<l.length;s++){var u=l[s].value/MAX_VALUE*MAX_HEIGHT,h=i(r,u),p=document.createElement("a-box"),c=t._colors.find(function(t){return t.key===l[s].key}).value,f={x:n,y:h,z:0};p.setAttribute("width",BAR_WIDTH),p.setAttribute("height",u),p.setAttribute("depth",BAR_DEPTH),p.setAttribute("color",c),p.setAttribute("position",f);var v=a[d].value;t._valueHandler&&(v=t._valueHandler(a[d]));var m=a[d].key;t._keyHandler&&(m=t._keyHandler(a[d]));var _={name:"key:"+m+" org:"+l[s].key+" value: "+l[s].value,data:{key:a[d].key,value:v},position:{x:f.x,y:MAX_HEIGHT+.25,z:f.z+o},origin_color:c};p._partData=_,t.appendChild(p);var E=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var o=t.el.parentElement.children,r=0;r<o.length;r++)o[r]!==t.el&&o[r]._group&&o[r].emit("data-loaded");t.el.emit("filtered",{element:e})}},g=E.bind(null,this,p._partData);p.addEventListener("click",g),r+=u}r=0,n+=BAR_WIDTH}this.addEvents(),t._colors&&this.addleyenda();for(var A=this.addYLabels(),b=0;b<A.length;b++)t.appendChild(A[b]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(t){var e=document.createElement("a-entity");e.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),e.setAttribute("position",{x:0,y:0,z:-this.data.depth/2}),this.el.appendChild(e)},addTitle:i.addTitle,addEvents:i.addEvents,addYLabels:function(){var t,e,a,i=function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=-.7,r=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var o={x:n,y:r,z:-t.data.depth/2};return i.setAttribute("position",o),i},n=this.el;a=this.el._data?this.el._data:this.el._group.top(1/0),e=n._maxfunc(n._group.order(n._maxfunc).top(1)[0].value),t=a.length;for(var r=e/this.data.ysteps,o=this.data.height/this.data.ysteps,d=[],l=0;l<this.data.ysteps+1;l++)d.push(i(this,l*o,l*r));return d},addleyenda:function(){var t=document.createElement("a-entity");t.id="barchart3dleyend";for(var e=this.el._group.top(1)[0],a=this.data.width+.25+1,i=this.data.height-.25,n=0;n<e.value.length;n++){var r=this.el._colors.find(function(t){return t.key===e.value[n].key}).value,o=document.createElement("a-box");o.setAttribute("color",r),o.setAttribute("width",.5),o.setAttribute("height",.5),o.setAttribute("depth",.5),o.setAttribute("position",{x:a,y:i,z:0});var d=document.createElement("a-entity");TEXT_WIDTH=6;var l=e.value[n].key;d.setAttribute("text",{color:"#000000",side:"double",value:l,width:TEXT_WIDTH,wrapCount:30,align:"left"}),d.setAttribute("position",{x:a+1+TEXT_WIDTH/2,y:i,z:0}),t.appendChild(d),t.appendChild(o),i-=.62}this.el.appendChild(t)},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))},pause:function(){},play:function(){}})},function(t,e){function a(){var t=function(t){console.log(this.name+": Data Loaded!"),this.reload=!0,t.target.components[this.name].update(this.data)},e=function(t){this.name;this.loaded=!1,this.el.addEventListener("data-loaded",this.onDataLoaded.bind(this))},a=function(t){if(this.el._data&&this.el._data.length>0||this.el._group)if(this.reload){for(;this.el.firstChild;)this.el.firstChild.parentNode.removeChild(this.el.firstChild);this.initChart(),this.reload=!1,this.el.setAttribute("visible",!0)}else{var e=AFRAME.utils.diff(t,this.data);if(""!==e.title){var a=this.el.querySelector("[title]");a&&a.setAttribute("title","caption",e.title)}}},i=function(){for(var t=function(t,i){i.addEventListener("mouseenter",e.bind(t,i)),i.addEventListener("mouseleave",a.bind(t,i))},e=function(t){r(this,t),o(t)},a=function(t){i(t),n(t)},i=function(t){var e=t;e.setAttribute("color",t._partData.origin_color)},n=function(t){var e=t.parentElement,a=e.querySelector("#tooltip");a&&e.removeChild(a)},r=function(t,e){var a;a=document.createElement("a-entity");var i=Number.parseInt(e._partData.origin_color.replace("#","0x"))-1315860;i="#"+("000000"+i.toString(16)).slice(-6);var n=6;a.setAttribute("text",{color:"#000000",side:"double",value:t._tooltip?t._tooltip(e.data):e._partData.name,width:n,wrapCount:30});var r={x:e._partData.position.x+n/2,y:e._partData.position.y,z:e._partData.position.z};a.id="tooltip",a.setAttribute("position",r),e.parentElement.appendChild(a)},o=function(t){var e=t,a=e.getObject3D("mesh").material.color.getHex(),i=16777215^a;e.setAttribute("color","#"+("000000"+i.toString(16)).slice(-6))},d=0;d<this.el.children.length;d++)t(this.el,this.el.children[d])},n=function(){var t=document.createElement("a-entity");t.setAttribute("title",{caption:this.data.title,width:Math.max(this.data.width/2,6)}),t.setAttribute("position",{x:this.data.width/2,y:this.data.height+1,z:0}),this.el.appendChild(t)};return{onDataLoaded:t,default_init:e,default_update:a,addEvents:i,addTitle:n}}t.exports=a()},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-grid",{schema:{height:{default:1},width:{default:1},ysteps:{default:4},xsteps:{default:4}},multiple:!1,init:function(){},update:function(t){function e(t){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,-.2,0),new THREE.Vector3(0,i.height,0));var a=new THREE.Line(e,n);return a.position.set(t,0,0),a}function a(t){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(-.2,0,0),new THREE.Vector3(i.width,0,0));var a=new THREE.Line(e,n);return a.position.set(0,t,0),a}for(var i=this.data,n=new THREE.LineBasicMaterial({color:0,linewidth:1}),r=i.height/i.ysteps,o=new THREE.Object3D,d=0;d<i.ysteps+1;d++)o.add(a(d*r));for(var l=i.width/i.xsteps,d=0;d<i.xsteps+1;d++)o.add(e(d*l));this.el.setObject3D("group",o)},remove:function(){this.el.removeObject3D("group")},pause:function(){},play:function(){}})},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("title",{schema:{caption:{default:"",type:"string"},width:{default:7,type:"number"}},multiple:!1,update:function(t){var e,a=this.data;e=this.el;var i=a.width;e.setAttribute("text",{color:"#000000",side:"double",value:a.caption,align:"center",width:i,wrapCount:30})},remove:function(){},pause:function(){},play:function(){}})}]);